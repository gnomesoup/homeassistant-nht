# Message 14 received on amcrest2mqtt/AMR03225C8B908F530/event at 10:38 AM:
# {
#     "Code": "VideoMotion",
#     "action": "Stop",
#     "index": "6"
# }

# QoS: 0 - Retain: false
# Message 13 received on amcrest2mqtt/AMR03225C8B908F530/motion at 10:38 AM:

# off

# QoS: 0 - Retain: false
# Message 12 received on amcrest2mqtt/AMR03225C8B908F530/event at 10:37 AM:

# {
#     "Code": "VideoMotion",
#     "action": "Stop",
#     "index": "7"
# }

# QoS: 0 - Retain: false
# Message 11 received on amcrest2mqtt/AMR03225C8B908F530/motion at 10:37 AM:

# off

# QoS: 0 - Retain: false
# Message 10 received on amcrest2mqtt/AMR03225C8B908F530/event at 10:37 AM:

# {
#     "Code": "VideoMotion",
#     "action": "Start",
#     "index": "6"
# }

# QoS: 0 - Retain: false
# Message 9 received on amcrest2mqtt/AMR03225C8B908F530/motion at 10:37 AM:

# on

# QoS: 0 - Retain: false
# Message 8 received on amcrest2mqtt/AMR03225C8B908F530/event at 10:36 AM:

# {
#     "Code": "VideoMotion",
#     "action": "Start",
#     "index": "7"
# }
mqtt:
  binary_sensor:
    - name: "NVR Camera 8 Motion"
      unique_id: nvr_camera_8_motion
      state_topic: "amcrest2mqtt/AMR03225C8B908F530/event"
      value_template: >-
        {% if value_json.index == "7" and value_json.Code == "VideoMotion" %}
        {{ value_json.action }}
        {% else %}
        {{ states("binary_sensor.nvr_camera_8_motion") }}
        {% endif %}
      payload_on: "Start"
      payload_off: "Stop"
      availability:
        - topic: "amcrest2mqtt/AMR03225C8B908F530/status"
          payload_available: "online"
          payload_not_available: "offline"
      availability_mode: latest
    - name: "NVR Camera 8 Crossline"
      unique_id: nvr_camera_8_crossline
      state_topic: "amcrest2mqtt/AMR03225C8B908F530/event"
      value_template: >-
        {% if value_json.index == "7" and value_json.Code == "CrossLineDetection" %}
        {{ value_json.action }}
        {% else %}
        {{ states("binary_sensor.nvr_camera_8_crossline") }}
        {% endif %}
      payload_on: "Start"
      payload_off: "Stop"
      availability:
        - topic: "amcrest2mqtt/AMR03225C8B908F530/status"
          payload_available: "online"
          payload_not_available: "offline"
      availability_mode: latest
    - name: "NVR Camera 7 Motion"
      unique_id: nvr_camera_7_motion
      state_topic: "amcrest2mqtt/AMR03225C8B908F530/event"
      value_template: >-
        {% if value_json.index == "6" and value_json.Code == "VideoMotion" %}
          {% if value_json is defined %}
            {{ value_json.action }}
          {% else %}
            Stop
          {% endif %}
        {% else %}
        {{ states("binary_sensor.nvr_camera_7_motion") }}
        {% endif %}
      payload_on: "Start"
      payload_off: "Stop"
      availability:
        - topic: "amcrest2mqtt/AMR03225C8B908F530/status"
          payload_available: "online"
          payload_not_available: "offline"
      availability_mode: latest
